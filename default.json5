{
  $schema: 'https://docs.renovatebot.com/renovate-schema.json',
  description: 'This config defines the default Renovate rules that will be used in HiveMQ Product repos.',
  extends: [
    'config:recommended',
    'schedule:weekends',
    ':noUnscheduledUpdates'
  ],
  enabledManagers: [
    'gradle',
    'dockerfile',
    'github-actions',
    'npm',
    'regex',
  ],
  hostRules: [
    {
      matchHost: 'https://maven.pkg.github.com/hivemq/hivemq-commons',
      username: 'hivemq-jenkins',
      token: '{{ secrets.GITHUB_TOKEN_HIVEMQ_JENKINS }}',
    },
    {
      matchHost: 'https://maven.pkg.github.com/hivemq/vaadin-chartjs',
      username: 'hivemq-jenkins',
      token: '{{ secrets.GITHUB_TOKEN_HIVEMQ_JENKINS }}',
    },
    {
      matchHost: 'npm.pkg.github.com',
      hostType: 'npm',
      token: '{{ secrets.GITHUB_TOKEN_HIVEMQ_JENKINS }}',
    },
  ],
  major: {
    dependencyDashboardApproval: true,
  },
  pinDigests: true,
  labels: [
    'renovate',
  ],
  dependencyDashboardLabels: [
    'renovate',
  ],
  packageRules: [
    {
      description: 'configures the Maven registry for the Confluent Apache Kafka client',
      matchPackageNames: [
        'io.confluent:*',
        'org.apache.kafka:*'
      ],
      registryUrls: [
        'https://packages.confluent.io/maven'
      ]
    },
    {
      description: 'configures the Maven registry for hivemq-commons modules',
      matchPackageNames: [
        'com.hivemq.commons:*',
      ],
      registryUrls: [
        'https://maven.pkg.github.com/hivemq/hivemq-commons',
      ],
    },
    {
      description: 'configures the Maven registry for Vaadin ChartJs',
      matchPackageNames: [
        'com.byteowls:*',
      ],
      registryUrls: [
        'https://maven.pkg.github.com/hivemq/vaadin-chartjs',
      ],
    },
    {
      matchUpdateTypes: [
        'minor',
      ],
      matchCurrentVersion: '!/^0/',
      groupName: 'all minor dependencies',
      groupSlug: 'all-minor',
    },
    {
      matchUpdateTypes: [
        'patch',
      ],
      matchCurrentVersion: '!/^0/',
      groupName: 'all patch dependencies',
      groupSlug: 'all-patch',
      automerge: true,
    },
    {
      matchManagers: [
        'npm',
      ],
      matchUpdateTypes: [
        'minor',
      ],
      matchCurrentVersion: '!/^0/',
      groupName: 'all minor npm dependencies',
      groupSlug: 'all-minor-npm',
    },
    {
      matchManagers: [
        'npm',
      ],
      matchUpdateTypes: [
        'patch',
      ],
      matchCurrentVersion: '!/^0/',
      groupName: 'all patch npm dependencies',
      groupSlug: 'all-patch-npm',
      automerge: true,
    },
    {
      matchCurrentVersion: '/^0/',
      dependencyDashboardApproval: true,
    },
    {
      description: 'Xodus cannot be updated automatically - marked to be deprecated soon',
      matchPackageNames: [
        'org.jetbrains.xodus:*'
      ],
      enabled: false
    },
    {
      description: 'RocksDB cannot be updated automatically - requires deep analysis',
      matchPackageNames: [
        'org.rocksdb:*'
      ],
      enabled: false
    },
    {
      description: 'JGroups cannot be updated automatically - requires deep analysis',
      matchPackageNames: [
        'org.jgroups:*'
      ],
      enabled: false
    },
    {
      description: 'Netty 4.2 introduces breaking changes - we have to fix the extension classloader before we can update',
      matchPackageNames: [
        'io.netty:*'
      ],
      allowedVersions: '<4.2',
      groupName: 'non-major netty dependencies',
      groupSlug: 'non-major-netty'
    },
    {
      matchPackageNames: [
        '/^io\\.opentelemetry[.:].*/'
      ],
      ignoreUnstable: false,
      groupName: 'opentelemetry dependencies',
      groupSlug: 'opentelemetry'
    },
    {
      description: 'Vaadin 8.14.3 is the latest version that still has the Apache v2 license, so we cannot upgrade to newer versions',
      matchPackageNames: [
        'com.vaadin:*'
      ],
      matchCurrentVersion: '[8.14.3,)',
      allowedVersions: '<=8.14.3'
    },
    {
      description: 'avoid Kafka versions with commercial licenses, i.e. versions with ce suffixes',
      matchPackageNames: [
        'org.apache.kafka:*'
      ],
      allowedVersions: '!/ce$/'
    },
    {
      description: 'avoid JCTools versions with ea suffix (see https://github.com/JCTools/JCTools/issues/360)',
      matchPackageNames: [
        'org.jctools:*'
      ],
      allowedVersions: '!/ea$/'
    },
    {
      description: 'avoid updating HiveMQ SDKs',
      matchPackageNames: [
        '/^com\\.hivemq[.:].*-sdk$/'
      ],
      enabled: false
    },
    {
      description: 'avoid updating Gradle Enterprise plugins as these need to be updated in sync',
      matchPackageNames: [
        'com.gradle.develocity:com.gradle.develocity.gradle.plugin',
        'com.gradle.enterprise:com.gradle.enterprise.gradle.plugin',
        'com.gradle.common-custom-user-data-gradle-plugin:com.gradle.common-custom-user-data-gradle-plugin.gradle.plugin'
      ],
      enabled: false
    },
    {
      description: 'GitHub Actions major',
      matchManagers: [
        'github-actions'
      ],
      matchUpdateTypes: [
        'major'
      ],
      groupName: 'all major GitHub Actions dependencies',
      groupSlug: 'all-major-github-actions',
      dependencyDashboardApproval: false
    },
    {
      description: 'GitHub Actions minor & patch',
      matchManagers: [
        'github-actions'
      ],
      matchUpdateTypes: [
        'minor',
        'patch',
        'digest'
      ],
      groupName: 'all non-major GitHub Actions dependencies',
      groupSlug: 'all-non-major-github-actions',
      automerge: true
    },
  ],
}
